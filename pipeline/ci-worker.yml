version: 0.2
phases:
  install:
    runtime-versions:
      nodejs: 20
    commands:
      - python3 -m pip install --upgrade pip
      - python3 -m pip install --user aws-sam-cli
      - export PATH="$PATH:/root/.local/bin"
      - command -v esbuild >/dev/null 2>&1 || npm i -g esbuild@0.21.5
      - esbuild --version
      - apt-get update -y && apt-get install -y jq zip
  build:
    commands:
      - set -eu
      - echo "Root make target: $MAKE_TARGET (ENV=$ENV)"
      - make -e "$MAKE_TARGET"
artifacts:
  files:
    - "**/*"
  discard-paths: yes
